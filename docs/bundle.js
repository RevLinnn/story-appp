/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t,r,e={67:(t,r,e)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return r};var t,r={},e=Object.prototype,i=e.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function h(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{h({},"")}catch(t){h=function(t,r,e){return t[r]=e}}function f(r,e,n,o){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype);return h(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=E(u,n);if(c){if(c===p)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new O(o||[])),!0),a}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var p={};function y(){}function v(){}function d(){}var m={};h(m,u,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(_([])));w&&w!==e&&i.call(w,u)&&(m=w);var b=d.prototype=y.prototype=Object.create(m);function k(t){["next","throw","return"].forEach((function(r){h(t,r,(function(t){return this._invoke(r,t)}))}))}function x(t,r){function e(o,a,u,c){var s=l(t[o],t,a);if("throw"!==s.type){var h=s.arg,f=h.value;return f&&"object"==n(f)&&i.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,u,c)}),(function(t){e("throw",t,u,c)})):r.resolve(f).then((function(t){h.value=t,u(h)}),(function(t){return e("throw",t,u,c)}))}c(s.arg)}var o;h(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function E(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,E(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=l(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,p):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){this.tryEntries.push(t)}function j(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function O(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(r){if(null!=r){var e=r[u];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(i.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(n(r)+" is not iterable")}return v.prototype=d,h(b,"constructor",d),h(d,"constructor",v),v.displayName=h(d,s,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===v||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,h(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},r.awrap=function(t){return{__await:t}},k(x.prototype),h(x.prototype,c,(function(){return this})),r.AsyncIterator=x,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new x(f(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(b),h(b,s,"Generator"),h(b,u,(function(){return this})),h(b,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=_,O.prototype={constructor:O,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!r)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),j(e),p}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;j(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:_(r),r:e,n},"next"===this.method&&(this.arg=t),p}},r}function i(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function a(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return u(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function c(t){return btoa(String.fromCharCode.apply(String,a(new Uint8Array(t))))}function s(t,r){return h.apply(this,arguments)}function h(){var t;return t=o().mark((function t(r,e){var n,i,u,s,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(o="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",void 0,void 0,f=(o+"=".repeat(1)).replace(/-/g,"+").replace(/_/g,"/"),l=window.atob(f),Uint8Array.from(a(l).map((function(t){return t.charCodeAt(0)}))))});case 3:return n=t.sent,i={endpoint:n.endpoint,keys:{p256dh:c(n.getKey("p256dh")),auth:c(n.getKey("auth"))}},t.next=7,fetch("https://story-api.dicoding.dev/v1/notifications/subscribe",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(i)});case 7:if((u=t.sent).ok){t.next=13;break}return t.next=11,u.json();case 11:throw s=t.sent,new Error("Subscribe failed: ".concat(s.message||u.statusText));case 13:return t.next=15,u.json();case 15:h=t.sent,console.log(" Berhasil subscribe push notification:",h),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(0),console.error(" Gagal subscribe push notification:",t.t0);case 22:case"end":return t.stop()}var o,f,l}),t,null,[[0,19]])})),h=function(){var r=this,e=arguments;return new Promise((function(n,o){var a=t.apply(r,e);function u(t){i(a,n,o,u,c,"next",t)}function c(t){i(a,n,o,u,c,"throw",t)}u(void 0)}))},h.apply(this,arguments)}e.r(r),e.d(r,{subscribeUserToPush:()=>s})}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,o),i.exports}o.m=e,o.d=(t,r)=>{for(var e in r)o.o(r,e)&&!o.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:r[e]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((r,e)=>(o.f[e](t,r),r)),[])),o.u=t=>t+".bundle.js",o.miniCssF=t=>{},o.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),t={},r="storuy-app:",o.l=(e,n,i,a)=>{if(t[e])t[e].push(n);else{var u,c;if(void 0!==i)for(var s=document.getElementsByTagName("script"),h=0;h<s.length;h++){var f=s[h];if(f.getAttribute("src")==e||f.getAttribute("data-webpack")==r+i){u=f;break}}u||(c=!0,(u=document.createElement("script")).charset="utf-8",u.timeout=120,o.nc&&u.setAttribute("nonce",o.nc),u.setAttribute("data-webpack",r+i),u.src=e),t[e]=[n];var l=(r,n)=>{u.onerror=u.onload=null,clearTimeout(p);var o=t[e];if(delete t[e],u.parentNode&&u.parentNode.removeChild(u),o&&o.forEach((t=>t(n))),r)return r(n)},p=setTimeout(l.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=l.bind(null,u.onerror),u.onload=l.bind(null,u.onload),c&&document.head.appendChild(u)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.p="/",(()=>{var t={524:0};o.f.j=(r,e)=>{var n=o.o(t,r)?t[r]:void 0;if(0!==n)if(n)e.push(n[2]);else{var i=new Promise(((e,o)=>n=t[r]=[e,o]));e.push(n[2]=i);var a=o.p+o.u(r),u=new Error;o.l(a,(e=>{if(o.o(t,r)&&(0!==(n=t[r])&&(t[r]=void 0),n)){var i=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;u.message="Loading chunk "+r+" failed.\n("+i+": "+a+")",u.name="ChunkLoadError",u.type=i,u.request=a,n[1](u)}}),"chunk-"+r,r)}};var r=(r,e)=>{var n,i,[a,u,c]=e,s=0;if(a.some((r=>0!==t[r]))){for(n in u)o.o(u,n)&&(o.m[n]=u[n]);c&&c(o)}for(r&&r(e);s<a.length;s++)i=a[s],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0},e=self.webpackChunkstoruy_app=self.webpackChunkstoruy_app||[];e.forEach(r.bind(null,0)),e.push=r.bind(null,e.push.bind(e))})();const i=(t,r)=>r.some((r=>t instanceof r));let a,u;const c=new WeakMap,s=new WeakMap,h=new WeakMap;let f={get(t,r,e){if(t instanceof IDBTransaction){if("done"===r)return c.get(t);if("store"===r)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return y(t[r])},set:(t,r,e)=>(t[r]=e,!0),has:(t,r)=>t instanceof IDBTransaction&&("done"===r||"store"===r)||r in t};function l(t){f=t(f)}function p(t){return"function"==typeof t?(r=t,(u||(u=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(r)?function(...t){return r.apply(v(this),t),y(this.request)}:function(...t){return y(r.apply(v(this),t))}):(t instanceof IDBTransaction&&function(t){if(c.has(t))return;const r=new Promise(((r,e)=>{const n=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{r(),n()},i=()=>{e(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)}));c.set(t,r)}(t),i(t,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,f):t);var r}function y(t){if(t instanceof IDBRequest)return function(t){const r=new Promise(((r,e)=>{const n=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{r(y(t.result)),n()},i=()=>{e(t.error),n()};t.addEventListener("success",o),t.addEventListener("error",i)}));return h.set(r,t),r}(t);if(s.has(t))return s.get(t);const r=p(t);return r!==t&&(s.set(t,r),h.set(r,t)),r}const v=t=>h.get(t);function d(t,r,{blocked:e,upgrade:n,blocking:o,terminated:i}={}){const a=indexedDB.open(t,r),u=y(a);return n&&a.addEventListener("upgradeneeded",(t=>{n(y(a.result),t.oldVersion,t.newVersion,y(a.transaction),t)})),e&&a.addEventListener("blocked",(t=>e(t.oldVersion,t.newVersion,t))),u.then((t=>{i&&t.addEventListener("close",(()=>i())),o&&t.addEventListener("versionchange",(t=>o(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),u}const m=["get","getKey","getAll","getAllKeys","count"],g=["put","add","delete","clear"],w=new Map;function b(t,r){if(!(t instanceof IDBDatabase)||r in t||"string"!=typeof r)return;if(w.get(r))return w.get(r);const e=r.replace(/FromIndex$/,""),n=r!==e,o=g.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!o&&!m.includes(e))return;const i=async function(t,...r){const i=this.transaction(t,o?"readwrite":"readonly");let a=i.store;return n&&(a=a.index(r.shift())),(await Promise.all([a[e](...r),o&&i.done]))[0]};return w.set(r,i),i}l((t=>({...t,get:(r,e,n)=>b(r,e)||t.get(r,e,n),has:(r,e)=>!!b(r,e)||t.has(r,e)})));const k=["continue","continuePrimaryKey","advance"],x={},E=new WeakMap,S=new WeakMap,j={get(t,r){if(!k.includes(r))return t[r];let e=x[r];return e||(e=x[r]=function(...t){E.set(this,S.get(this)[r](...t))}),e}};async function*O(...t){let r=this;if(r instanceof IDBCursor||(r=await r.openCursor(...t)),!r)return;const e=new Proxy(r,j);for(S.set(e,r),h.set(e,v(r));r;)yield e,r=await(E.get(e)||r.continue()),E.delete(e)}function _(t,r){return r===Symbol.asyncIterator&&i(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===r&&i(t,[IDBIndex,IDBObjectStore])}function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function T(){T=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==P(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(P(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function G(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function N(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){G(i,n,o,a,u,"next",t)}function u(t){G(i,n,o,a,u,"throw",t)}a(void 0)}))}}l((t=>({...t,get:(r,e,n)=>_(r,e)?O:t.get(r,e,n),has:(r,e)=>_(r,e)||t.has(r,e)})));var A="stories",I=d("story-app-db",1,{upgrade:function(t){t.objectStoreNames.contains(A)||t.createObjectStore(A,{keyPath:"id"})}});const F=function(t){return N(T().mark((function r(){var e,n,o;return T().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,I;case 2:return e=r.sent,n=e.transaction(A,"readwrite"),o=n.objectStore(A),t.forEach((function(t){return o.put(t)})),r.next=8,n.done;case 8:case"end":return r.stop()}}),r)})))()},B=function(){return N(T().mark((function t(){var r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I;case 2:return r=t.sent,t.abrupt("return",r.getAll(A));case 4:case"end":return t.stop()}}),t)})))()},C=function(){return N(T().mark((function t(){var r,e;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I;case 2:return r=t.sent,e=r.transaction(A,"readwrite"),t.next=6,e.objectStore(A).clear();case 6:return t.next=8,e.done;case 8:case"end":return t.stop()}}),t)})))()};function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function q(){q=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==D(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(D(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function M(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function U(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){M(i,n,o,a,u,"next",t)}function u(t){M(i,n,o,a,u,"throw",t)}a(void 0)}))}}function H(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R(n.key),n)}}function R(t){var r=function(t){if("object"!=D(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=D(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==D(r)?r:r+""}var W=function(){return t=function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.apiUrl="https://story-api.dicoding.dev/v1",this.getToken=r},r=[{key:"fetchStories",value:(o=U(q().mark((function t(){var r,e,n;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(this.apiUrl,"/stories?location=1"),{method:"GET",headers:{Authorization:"Bearer ".concat(this.getToken())}});case 3:return r=t.sent,t.next=6,r.json();case 6:if(!(e=t.sent).error){t.next=9;break}throw new Error(e.message);case 9:return t.next=11,C();case 11:return t.next=13,F(e.listStory);case 13:return t.abrupt("return",e.listStory);case 16:return t.prev=16,t.t0=t.catch(0),console.warn("Gagal fetch online, ambil dari IndexedDB",t.t0),t.next=21,B();case 21:return n=t.sent,t.abrupt("return",n);case 23:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(){return o.apply(this,arguments)})},{key:"fetchStoryById",value:(n=U(q().mark((function t(r){var e,n;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(this.apiUrl,"/stories/").concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(this.getToken())}});case 3:return e=t.sent,t.next=6,e.json();case 6:if(!(n=t.sent).error){t.next=9;break}throw new Error(n.message);case 9:return t.abrupt("return",n.story);case 12:throw t.prev=12,t.t0=t.catch(0),t.t0;case 15:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(t){return n.apply(this,arguments)})},{key:"addStory",value:(e=U(q().mark((function t(r){var e,n,o,i,a,u,c;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.description,n=r.photoBlob,o=r.lat,i=r.lon,t.prev=1,(a=new FormData).append("description",e),a.append("photo",n,"photo.jpg"),void 0!==o&&a.append("lat",o),void 0!==i&&a.append("lon",i),t.next=9,fetch("".concat(this.apiUrl,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.getToken())},body:a});case 9:return u=t.sent,t.next=12,u.json();case 12:if(!(c=t.sent).error){t.next=15;break}throw new Error(c.message);case 15:if(!c.story){t.next=18;break}return t.next=18,F([c.story]);case 18:return t.abrupt("return",c);case 21:throw t.prev=21,t.t0=t.catch(1),t.t0;case 24:case"end":return t.stop()}}),t,this,[[1,21]])}))),function(t){return e.apply(this,arguments)})}],r&&H(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,e,n,o}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function Y(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,K(n.key),n)}}function K(t){var r=function(t){if("object"!=z(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=z(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(r)?r:r+""}var V=function(){return t=function t(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerId=r,this.options=e,this.map=null,this.marker=null,this.initMap()},r=[{key:"initMap",value:function(){var t=this.options,r=t.center,e=void 0===r?[0,0]:r,n=t.zoom,o=void 0===n?2:n;this.map=L.map(this.containerId).setView(e,o),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap contributors"}).addTo(this.map),this.options.onClick&&this.map.on("click",this.options.onClick)}},{key:"addMarker",value:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.marker&&this.map.removeLayer(this.marker),this.marker=L.marker([t,r]).addTo(this.map),e&&this.marker.bindPopup(e).openPopup()}},{key:"clearMarker",value:function(){this.marker&&(this.map.removeLayer(this.marker),this.marker=null)}},{key:"flyTo",value:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:13;this.map&&this.map.flyTo([t,r],e)}}],r&&Y(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function $(){$=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==J(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(J(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function Q(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function Z(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Q(i,n,o,a,u,"next",t)}function u(t){Q(i,n,o,a,u,"throw",t)}a(void 0)}))}}var X={getDB:function(){return Z($().mark((function t(){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d("bookmark-db",1,{upgrade:function(t){t.objectStoreNames.contains("bookmarks")||t.createObjectStore("bookmarks",{keyPath:"id"})}}));case 1:case"end":return t.stop()}}),t)})))()},put:function(t){var r=this;return Z($().mark((function e(){var n;return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getDB();case 2:return n=e.sent,e.abrupt("return",n.put("bookmarks",t));case 4:case"end":return e.stop()}}),e)})))()},getAll:function(){var t=this;return Z($().mark((function r(){var e;return $().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getDB();case 2:return e=r.sent,r.abrupt("return",e.getAll("bookmarks"));case 4:case"end":return r.stop()}}),r)})))()},delete:function(t){var r=this;return Z($().mark((function e(){var n;return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getDB();case 2:return n=e.sent,e.abrupt("return",n.delete("bookmarks",t));case 4:case"end":return e.stop()}}),e)})))()}};function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function rt(){rt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==tt(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(tt(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function et(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function nt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){et(i,n,o,a,u,"next",t)}function u(t){et(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ot(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,it(n.key),n)}}function it(t){var r=function(t){if("object"!=tt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=tt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==tt(r)?r:r+""}var at=function(){return t=function t(r,e){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=r,this.stories=e},(r=[{key:"render",value:function(){var t=this;Array.isArray(this.stories)&&0!==this.stories.length?(this.container.innerHTML="",this.stories.forEach((function(r){var e=document.createElement("article");e.className="story-item",e.setAttribute("tabindex","0"),e.innerHTML='\n        <img src="'.concat(r.photoUrl,'" alt="Foto cerita oleh ').concat(r.name,'" />\n        <div class="story-texts">\n          <h2>').concat(r.name,"</h2>\n          <p>").concat(r.description,"</p>\n          <p>Tanggal: ").concat(new Date(r.createdAt).toLocaleString(),"</p>\n          <p>Latitude: ").concat(r.lat,"</p>\n          <p>Longitude: ").concat(r.lon,'</p>\n          <div id="map-list-').concat(r.id,'" class="map-list"></div>\n          <button class="btn-bookmark" data-id="').concat(r.id,'" aria-label="Tambahkan ke bookmark">\n          Bookmark\n    </button>\n        </div>\n      '),t.container.appendChild(e),void 0!==r.lat&&void 0!==r.lon&&new V("map-list-".concat(r.id),{center:[r.lat,r.lon],zoom:13}).addMarker(r.lat,r.lon,r.name),e.querySelector(".btn-bookmark").style.marginTop="12px",e.querySelector(".btn-bookmark").addEventListener("click",nt(rt().mark((function t(){return rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,X.put(r);case 3:alert('"'.concat(r.name,'" ditambahkan ke bookmark.')),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),alert("Gagal menambahkan ke bookmark: "+t.t0.message);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))))}))):this.container.innerHTML="<p>Belum ada story untuk ditampilkan.</p>"}}])&&ot(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function ct(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function st(t){var r=function(t){if("object"!=ut(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=ut(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ut(r)?r:r+""}var ht=function(){return t=function t(){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t)},r=[{key:"stopAllStreams",value:function(){Array.isArray(window.currentStreams)?(window.currentStreams.forEach((function(t){t.getTracks().forEach((function(t){return t.stop()}))})),window.currentStreams=[]):window.currentStreams=[]}},{key:"registerStream",value:function(t){Array.isArray(window.currentStreams)||(window.currentStreams=[]),window.currentStreams.push(t)}}],null&&ct(t.prototype,null),r&&ct(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function lt(){lt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==ft(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(ft(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function pt(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function yt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){pt(i,n,o,a,u,"next",t)}function u(t){pt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function vt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dt(n.key),n)}}function dt(t){var r=function(t){if("object"!=ft(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=ft(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ft(r)?r:r+""}var mt=function(){return t=function t(r,e){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=r,this.addStoryCallback=e,this.videoStream=null,this.videoEl=null,this.canvasEl=null,this.photoBlob=null,this.selectedLat=void 0,this.selectedLon=void 0},r=[{key:"render",value:function(){var t=this;this.container.innerHTML='\n      <h2>Tambah Cerita Baru</h2>\n      <form id="form-add-story">\n        <label for="description">Deskripsi:</label>\n        <input type="text" id="description" name="description" required />\n        \n        <label for="photo">Upload Foto:</label>\n        <input type="file" id="photo" name="photo" accept="image/*" />\n        \n        <button type="button" id="btn-start-camera">Ambil Foto dengan Kamera</button>\n        \n        <div id="camera-stream" style="display:none;">\n          <video id="video" autoplay muted playsinline style="max-width: 100%;"></video>\n          <canvas id="canvas" style="display:none;"></canvas>\n          <div>\n            <button type="button" id="btn-capture">Ambil Gambar</button>\n            <button type="button" id="btn-stop-camera">Berhenti Kamera</button>\n            <button type="button" id="btn-retake-photo" style="display:none;">Ulangi Foto</button>\n          </div>\n        </div>\n        \n        <label>Pilih Lokasi Cerita (klik di peta):</label>\n        <div id="map-add" style="height: 300px;"></div>\n        <p id="location-info"></p>\n        \n        <button type="submit">Kirim Cerita</button>\n      </form>\n      \n      <div id="preview-container"></div>\n    ',this.videoEl=this.container.querySelector("#video"),this.canvasEl=this.container.querySelector("#canvas"),this.container.querySelector("#btn-start-camera").addEventListener("click",(function(){return t.startCamera()})),this.container.querySelector("#btn-capture").addEventListener("click",(function(){return t.capturePhoto()})),this.container.querySelector("#btn-stop-camera").addEventListener("click",(function(){return t.stopCamera()})),this.container.querySelector("#btn-retake-photo").addEventListener("click",(function(){return t.retakePhoto()})),this.container.querySelector("#form-add-story").addEventListener("submit",(function(r){return t.submitForm(r)})),this.map=new V("map-add",{center:[-.7893,113.9213],zoom:5,onClick:function(r){return t.handleMapClick(r)}})}},{key:"startCamera",value:(n=yt(lt().mark((function t(){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){t.next=16;break}return t.prev=1,t.next=4,navigator.mediaDevices.getUserMedia({video:!0});case 4:this.videoStream=t.sent,this.videoEl.srcObject=this.videoStream,this.videoEl.style.display="block",this.container.querySelector("#camera-stream").style.display="block",ht.registerStream(this.videoStream),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),alert("Tidak bisa mengakses kamera: "+t.t0.message);case 14:t.next=17;break;case 16:alert("Browser Anda tidak mendukung fitur kamera.");case 17:case"end":return t.stop()}}),t,this,[[1,11]])}))),function(){return n.apply(this,arguments)})},{key:"stopCamera",value:function(){this.videoStream&&(this.videoStream.getTracks().forEach((function(t){return t.stop()})),this.videoStream=null),this.container.querySelector("#btn-retake-photo").style.display="none",this.videoEl.style.display="none",this.container.querySelector("#camera-stream").style.display="none"}},{key:"capturePhoto",value:function(){var t=this,r=this.videoEl.videoWidth,e=this.videoEl.videoHeight;this.canvasEl.width=r,this.canvasEl.height=e,this.canvasEl.getContext("2d").drawImage(this.videoEl,0,0,r,e),this.canvasEl.toBlob((function(r){t.photoBlob=r,t.showPreviewOnCamera(r),t.stopCamera()}),"image/jpeg")}},{key:"showPreviewOnCamera",value:function(t){var r=this.container.querySelector("#preview-container"),e=r.querySelector("img");e&&e.remove();var n=document.createElement("img");n.src=URL.createObjectURL(t),n.alt="Preview Gambar",n.style.maxWidth="100%",n.style.marginTop="10px",r.appendChild(n),this.container.querySelector("#btn-retake-photo").style.display="inline-block"}},{key:"retakePhoto",value:function(){var t=this.container.querySelector("#preview-container").querySelector("img");t&&t.remove(),this.container.querySelector("#btn-retake-photo").style.display="none",this.videoEl.style.display="block",this.startCamera()}},{key:"handleMapClick",value:function(t){var r=t.latlng;this.selectedLat=r.lat,this.selectedLon=r.lng,this.container.querySelector("#location-info").textContent="Latitude: ".concat(this.selectedLat.toFixed(6),", Longitude: ").concat(this.selectedLon.toFixed(6)),this.map.addMarker(this.selectedLat,this.selectedLon,"Lokasi cerita")}},{key:"submitForm",value:(e=yt(lt().mark((function t(r){var e,n;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),e=this.container.querySelector("#description").value.trim()){t.next=5;break}return alert("Deskripsi wajib diisi"),t.abrupt("return");case 5:if(n=this.photoBlob||this.container.querySelector("#photo").files[0]){t.next=9;break}return alert("Foto wajib di-upload atau diambil menggunakan kamera"),t.abrupt("return");case 9:if(!(n.size>1048576)){t.next=12;break}return alert("Ukuran foto maksimal 1MB"),t.abrupt("return");case 12:if(void 0!==this.selectedLat&&void 0!==this.selectedLon){t.next=15;break}return alert("Silakan pilih lokasi cerita di peta"),t.abrupt("return");case 15:this.addStoryCallback({description:e,photoBlob:n,lat:this.selectedLat,lon:this.selectedLon}),this.container.querySelector("#form-add-story").reset(),this.container.querySelector("#preview-container").innerHTML="",this.container.querySelector("#location-info").textContent="",ht.stopAllStreams(),this.map.clearMarker();case 21:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}],r&&vt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,e,n}();function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function wt(){wt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==gt(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(gt(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function bt(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function kt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){bt(i,n,o,a,u,"next",t)}function u(t){bt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function xt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Et(n.key),n)}}function Et(t){var r=function(t){if("object"!=gt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=gt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gt(r)?r:r+""}var St=function(){return t=function t(r,e,n){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=r,this.model=e,this.bookmarkPresenter=n},r=[{key:"route",value:(o=kt(wt().mark((function t(r){return wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next="stories"===t.t0?3:"add-story"===t.t0?6:8;break;case 3:return t.next=5,this.showStoriesPage();case 5:return t.abrupt("break",10);case 6:return this.showAddStoryPage(),t.abrupt("break",10);case 8:return this.showNotFound(),t.abrupt("break",10);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"showStoriesPage",value:(n=kt(wt().mark((function t(){var r,e=this;return wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.model.fetchStories();case 3:r=t.sent,new at(this.container,r,{onBookmark:function(t){return e.bookmarkPresenter.addBookmark(t)}}).render(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.container.innerHTML="<p>Gagal memuat cerita: ".concat(t.t0.message,"</p>");case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return n.apply(this,arguments)})},{key:"showAddStoryPage",value:function(){var t=this,r=new mt(this.container,function(){var r=kt(wt().mark((function r(e){return wt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.addStory(e);case 2:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}());r.render()}},{key:"addStory",value:(e=kt(wt().mark((function t(r){return wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.model.addStory(r);case 3:alert("Cerita berhasil ditambahkan!"),window.location.hash="#/stories",t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),alert("Gagal menambahkan cerita: "+t.t0.message);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return e.apply(this,arguments)})},{key:"showNotFound",value:function(){this.container.innerHTML="<p>Halaman tidak ditemukan.</p>"}}],r&&xt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,e,n,o}();function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Ot(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_t(n.key),n)}}function _t(t){var r=function(t){if("object"!=jt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=jt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jt(r)?r:r+""}var Pt=function(){return t=function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=r},(r=[{key:"renderLogin",value:function(){this.container.innerHTML='\n            <h2>Login</h2>\n            <form id="form-login">\n                <label for="email">Email:</label>\n                <input type="email" id="email" name="email" required autocomplete="username" />\n                <label for="password">Password:</label>\n                <input type="password" id="password" name="password" required autocomplete="current-password" minlength="8" />\n                <button type="submit">Login</button>\n            </form>\n            <p>Belum punya akun? <a href="#/register">Daftar di sini</a></p>\n        '}},{key:"renderRegister",value:function(){this.container.innerHTML='\n            <h2>Register</h2>\n            <form id="form-register">\n                <label for="name">Nama:</label>\n                <input type="text" id="name" name="name" required autocomplete="name" />\n                <label for="email">Email:</label>\n                <input type="email" id="email" name="email" required autocomplete="email" />\n                <label for="password">Password:</label>\n                <input type="password" id="password" name="password" required minlength="8" autocomplete="new-password" />\n                <button type="submit">Register</button>\n            </form>\n            <p>Sudah punya akun? <a href="#/login">Login di sini</a></p>\n        '}},{key:"getLoginFormData",value:function(){return{email:this.container.querySelector("#email").value.trim(),password:this.container.querySelector("#password").value.trim()}}},{key:"getRegisterFormData",value:function(){return{name:this.container.querySelector("#name").value.trim(),email:this.container.querySelector("#email").value.trim(),password:this.container.querySelector("#password").value.trim()}}},{key:"showAlert",value:function(t){alert(t)}}])&&Ot(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();function Tt(t){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tt(t)}function Gt(){Gt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==Tt(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(Tt(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function Lt(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function Nt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Lt(i,n,o,a,u,"next",t)}function u(t){Lt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function At(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,It(n.key),n)}}function It(t){var r=function(t){if("object"!=Tt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=Tt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Tt(r)?r:r+""}var Ft=function(){return t=function t(r,e){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=new Pt(r),this.setToken=e},r=[{key:"showLogin",value:function(){this.view.renderLogin(),this.addLoginEvent()}},{key:"showRegister",value:function(){this.view.renderRegister(),this.addRegisterEvent()}},{key:"addLoginEvent",value:function(){var t=this;this.view.container.querySelector("#form-login").addEventListener("submit",(function(r){return t.submitLogin(r)}))}},{key:"addRegisterEvent",value:function(){var t=this;this.view.container.querySelector("#form-register").addEventListener("submit",(function(r){return t.submitRegister(r)}))}},{key:"submitLogin",value:(n=Nt(Gt().mark((function t(r){var e,n,i,a,u,c,s,h,f;return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),e=this.view.getLoginFormData(),n=e.email,i=e.password,n&&i){t.next=5;break}return this.view.showAlert("Email dan password harus diisi"),t.abrupt("return");case 5:return t.next=7,o.e(622).then(o.bind(o,622));case 7:return a=t.sent,u=new a.default((function(){return""})),t.prev=9,t.next=12,u.login({email:n,password:i});case 12:if(c=t.sent,this.setToken(c.token),!("serviceWorker"in navigator)){t.next=30;break}return t.prev=15,t.next=18,navigator.serviceWorker.ready;case 18:return s=t.sent,t.next=21,Promise.resolve().then(o.bind(o,67));case 21:return h=t.sent,f=h.subscribeUserToPush,t.next=25,f(s,c.token);case 25:t.next=30;break;case 27:t.prev=27,t.t0=t.catch(15),console.warn("Gagal subscribe push notification setelah login:",t.t0);case 30:this.view.showAlert("Login berhasil, selamat datang ".concat(c.name)),window.location.hash="#/stories",t.next=37;break;case 34:t.prev=34,t.t1=t.catch(9),this.view.showAlert("Login gagal: "+t.t1.message);case 37:case"end":return t.stop()}}),t,this,[[9,34],[15,27]])}))),function(t){return n.apply(this,arguments)})},{key:"submitRegister",value:(e=Nt(Gt().mark((function t(r){var e,n,i,a,u,c,s;return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),e=this.view.getRegisterFormData(),n=e.name,i=e.email,a=e.password,n&&i&&a){t.next=5;break}return this.view.showAlert("Semua field wajib diisi"),t.abrupt("return");case 5:if(!(a.length<8)){t.next=8;break}return this.view.showAlert("Password minimal 8 karakter"),t.abrupt("return");case 8:return t.next=10,o.e(622).then(o.bind(o,622));case 10:return u=t.sent,c=new u.default((function(){return""})),t.prev=12,t.next=15,c.register({name:n,email:i,password:a});case 15:s=t.sent,this.view.showAlert(s+". Silakan login sekarang."),window.location.hash="#/login",t.next=23;break;case 20:t.prev=20,t.t0=t.catch(12),this.view.showAlert("Register gagal: "+t.t0.message);case 23:case"end":return t.stop()}}),t,this,[[12,20]])}))),function(t){return e.apply(this,arguments)})}],r&&At(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,e,n}(),Bt=o(67);function Ct(t){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ct(t)}function Dt(){Dt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==Ct(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(Ct(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function qt(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function Mt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ut(n.key),n)}}function Ut(t){var r=function(t){if("object"!=Ct(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=Ct(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ct(r)?r:r+""}var Ht=function(){return t=function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=r},r=[{key:"render",value:(e=Dt().mark((function t(r){var e=this;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Array.isArray(r)&&0!==r.length){t.next=3;break}return this.container.innerHTML="<p>Belum ada bookmark.</p>",t.abrupt("return");case 3:this.container.innerHTML="",r.forEach((function(t){var r,n,o=document.createElement("article");o.className="story-item",o.setAttribute("tabindex","0"),o.innerHTML='\n        <img src="'.concat(t.photoUrl,'" alt="Foto cerita oleh ').concat(t.name,'" />\n        <div class="story-texts">\n          <h2>').concat(t.name,"</h2>\n          <p>").concat(t.description,"</p>\n          <p>Tanggal: ").concat(new Date(t.createdAt).toLocaleString(),"</p>\n          <p>Latitude: ").concat(null!==(r=t.lat)&&void 0!==r?r:"-","</p>\n          <p>Longitude: ").concat(null!==(n=t.lon)&&void 0!==n?n:"-",'</p>\n          <div id="map-bookmark-').concat(t.id,'" class="map-list" style="height: 200px;"></div>\n          <button class="btn-delete" data-id="').concat(t.id,'">Hapus Bookmark</button>\n        </div>\n      '),e.container.appendChild(o),o.querySelector(".btn-delete").style.marginTop="12px",void 0!==t.lat&&void 0!==t.lon&&new V("map-bookmark-".concat(t.id),{center:[t.lat,t.lon],zoom:13}).addMarker(t.lat,t.lon,t.name)}));case 5:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){qt(i,n,o,a,u,"next",t)}function u(t){qt(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})},{key:"bindDelete",value:function(t){this.container.addEventListener("click",(function(r){if(r.target.classList.contains("btn-delete")){var e=r.target.dataset.id;t(e)}}))}}],r&&Mt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,e,n}();function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function Wt(){Wt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==Rt(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(Rt(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function zt(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function Yt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){zt(i,n,o,a,u,"next",t)}function u(t){zt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Kt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vt(n.key),n)}}function Vt(t){var r=function(t){if("object"!=Rt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var e=r.call(t,"string");if("object"!=Rt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rt(r)?r:r+""}var Jt=function(){return t=function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=new Ht(r)},r=[{key:"showBookmarks",value:(o=Yt(Wt().mark((function t(){var r;return Wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.getAll();case 2:r=t.sent,this.view.render(r),this.view.bindDelete(this.handleDelete.bind(this));case 5:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"handleDelete",value:(n=Yt(Wt().mark((function t(r){return Wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.delete(r);case 2:this.showBookmarks();case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"addBookmark",value:(e=Yt(Wt().mark((function t(r){return Wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.put(r);case 2:alert("Story telah disimpan ke Bookmark!");case 3:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})}],r&&Kt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,e,n,o}();function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function Qt(){Qt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=h(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var f={};function l(){}function p(){}function y(){}var v={};c(v,i,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(j([])));m&&m!==e&&n.call(m,i)&&(v=m);var g=y.prototype=l.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==$t(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function x(t){this.tryEntries.push(t)}function E(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(x,this),this.reset(!0)}function j(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError($t(r)+" is not iterable")}return p.prototype=y,c(g,"constructor",y),c(y,"constructor",p),p.displayName=c(y,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=j,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),E(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;E(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:j(r),r:e,n},"next"===this.method&&(this.arg=t),f}},r}function Zt(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function Xt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Zt(i,n,o,a,u,"next",t)}function u(t){Zt(i,n,o,a,u,"throw",t)}a(void 0)}))}}var tr=document.getElementById("main-content"),rr=function(){return localStorage.getItem("token")||""},er=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t?localStorage.setItem("token",t):localStorage.removeItem("token")};window.addEventListener("hashchange",(function(){ht.stopAllStreams(),lr()})),document.addEventListener("DOMContentLoaded",Xt(Qt().mark((function t(){var r,e;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("serviceWorker"in navigator)){t.next=27;break}return t.prev=1,t.next=4,navigator.serviceWorker.register("sw.js");case 4:return r=t.sent,console.log("Service Worker terdaftar."),t.next=8,Notification.requestPermission();case 8:if("granted"!==t.sent){t.next=19;break}if(!(e=rr())){t.next=16;break}return t.next=14,(0,Bt.subscribeUserToPush)(r,e);case 14:t.next=17;break;case 16:console.warn("Tidak ada token login. Push tidak di-subscribe.");case 17:t.next=20;break;case 19:console.warn("Izin notifikasi ditolak.");case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(1),console.error("Gagal mendaftarkan Service Worker:",t.t0);case 25:t.next=28;break;case 27:console.warn("Service Worker tidak didukung.");case 28:case"end":return t.stop()}}),t,null,[[1,22]])}))));var nr=new Jt(tr),or=new W((function(){return rr()})),ir=new St(tr,or,nr),ar=new Ft(tr,er),ur=(document.getElementById("nav-list"),document.getElementById("btn-logout")),cr=document.getElementById("link-login");function sr(){var t=!!rr();ur.style.display=t?"inline-block":"none",cr.style.display=t?"none":"inline-block"}function hr(t){return fr.apply(this,arguments)}function fr(){return(fr=Xt(Qt().mark((function t(r){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:tr.innerHTML="",t.t0=r,t.next="stories"===t.t0?4:"add-story"===t.t0?7:"bookmarks"===t.t0?10:"login"===t.t0?13:"register"===t.t0?15:17;break;case 4:return t.next=6,ir.route(r);case 6:case 9:case 12:return t.abrupt("break",19);case 7:return t.next=9,ir.route(r);case 10:return t.next=12,nr.showBookmarks();case 13:return ar.showLogin(),t.abrupt("break",19);case 15:return ar.showRegister(),t.abrupt("break",19);case 17:return tr.innerHTML="<p>Halaman tidak ditemukan.</p>",t.abrupt("break",19);case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function lr(){return pr.apply(this,arguments)}function pr(){return(pr=Xt(Qt().mark((function t(){var r,e;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=window.location.hash||"#/stories",e=r.startsWith("#/")?r.slice(2):r.slice(1),rr()||"stories"!==e&&"add-story"!==e){t.next=6;break}return window.location.hash="#/login",t.abrupt("return");case 6:if(sr(),!document.startViewTransition){t.next=11;break}document.startViewTransition((function(){return hr(e)})),t.next=13;break;case 11:return t.next=13,hr(e);case 13:tr&&tr.focus();case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}ur.addEventListener("click",(function(){er(""),sr(),window.location.hash="#/login"})),window.addEventListener("hashchange",lr),window.addEventListener("load",(function(){sr(),lr()}))})();